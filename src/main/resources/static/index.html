<html>
<head>
  <link rel="stylesheet" href="lib/leaflet/leaflet.css" type="text/css">

  <style>
    #map { height: 100%; }
  </style>

  <script src="lib/leaflet/leaflet.js"></script>
  <script src="lib/map-builder.js"></script>
  <script src="lib/nyarfas.js"></script>
</head>
<body>
<div id="map" class="map-container"></div>

<script th:inline="javascript">
/*<![CDATA[*/

	let mapElement = document.getElementById('map')
    let map = MapBuilder.createMap(mapElement, [47.54185120071823, 18.718836308347555])

    var markers = /*[[${markers}]]*/ '[]';
    var markerList = JSON.parse(markers);
    for (const marker of markerList) {
      var mapMarker = L.marker([marker.gpsCoordinates.latitude, marker.gpsCoordinates.longitude]).addTo(map);
      var popup = "";
      for (const label of marker.labels) {
        var displayDate = label.date;
        if (displayDate != null) {
          displayDate = "(" + displayDate + ") ";
        } else {
          displayDate = "";
        }
        popup += "<b>" + label.name + "</b> " + displayDate;
      }
      mapMarker.bindPopup(popup);
    }
    map.setMaxZoom(20);
    map.setMinZoom(7);
    map.setZoom(18);
    addStreet(map);
    var houses = getHouses();
    houses.forEach((house) => {
      addHouseToMap(map, house);
      //addSeasonToMap(map, house);
      addHouseNumberAsMarkerToMap(map, house);
      });
/*]]>*/
</script>
</body>
</html>